<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chatbot V4</title>
  </head>
  <body>
    <style>
      /* Styles inchangés */
    </style>
    <div id="chat"></div>
    <div id="user-div">
      <input type="text" placeholder="Entrez une question" id="user-input" />
      <button onclick="submit()">Envoyer</button>
    </div>
    <script>
      const userInput = document.getElementById('user-input');
      const chat = document.getElementById('chat');
      let submit = function() {};

      fetch('data.json')
        .then((response) => response.json())
        .then((data) => {
          function submitData() {
            // Création du message de l'utilisateur
            let userMsg = document.createElement('p');
            userMsg.classList.add('user-msg');
            userMsg.textContent = userInput.value;
            chat.appendChild(userMsg);

            // Recherche dans les questions du fichier JSON
            let responseFound = false; // Variable pour vérifier si une réponse a été trouvée
            for (let question in data.questions) {
              // Vérifie si la question de l'utilisateur est incluse dans une des questions du fichier
              if (data.questions.hasOwnProperty(question) && question.toLowerCase().includes(userInput.value.toLowerCase())) {
                let botMsg = document.createElement('p');
                botMsg.textContent = data.questions[question];
                botMsg.classList.add('bot-msg');
                chat.appendChild(botMsg);
                responseFound = true;
                break; // Stoppe la boucle une fois qu'une réponse est trouvée
              }
            }

            // Si aucune réponse n'a été trouvée, afficher un message par défaut
            if (!responseFound) {
              let botMsg = document.createElement('p');
              botMsg.textContent = "Désolé, je ne comprends pas cette question.";
              botMsg.classList.add('bot-msg');
              chat.appendChild(botMsg);
            }
          }

          submit = () => {
            submitData();
          };
        })
        .catch((err) => {
          console.error('Erreur', err);
        });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && userInput.value !== '') {
          submit();
        }
      });
    </script>
  </body>
</html>
